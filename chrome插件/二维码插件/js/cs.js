function clearContainer(){var a=$(getContainer());a.hide(),a.find(".anything-to-qrcode-item").remove(),a.find(".anything-to-qrcode-text-result").remove(),self.clip.destroy()}function getContainer(){var a=document.getElementById("anything2qrcode");if(!a){a=document.createElement("div"),a.id="anything2qrcode";var b=document.createElement("button");b.innerHTML=chrome.i18n.getMessage("close"),b.className="anything-to-qrcode-close",a.appendChild(b);var c=function(){self.preventClose||clearContainer()};b.addEventListener("click",function(){self.preventClose=!1,c()}),document.addEventListener("click",function(){c()}),a.style.display="none",document.body.appendChild(a)}return a}function createCode(a){var b=getContainer();b.style.display="block";var c=document.createElement("div");c.className="anything-to-qrcode-item",c.style.cssText="box-sizing: content-box;";var d=document.createElement("div");d.className="anything-to-qrcode-item-img",$imgWrapper=$(d),$imgWrapper.qrcode({width:200,height:200,text:utf16to8(a)});var e=""+$imgWrapper.find("canvas")[0].toDataURL();$imgWrapper.find("canvas").replaceWith($('<img src="'+e+'" width="200" />'));var f=$('<div style="padding: 8px 0 0 0;overflow: hidden;"></div>'),g=$('<a download="qrcode_'+gid+'.png" href="'+e+'" style="font-size: 14px;color: #005eac;float: right;height: 20px;line-height: 20px;">'+chrome.i18n.getMessage("save")+"</a>"),h=document.createElement("h4");h.className="anything-to-qrcode-item-title",h.innerHTML=a,h.title=a,h.style.cssText="box-sizing: border-box;font-size: 12px;width: 165px;float: left;height: 20px;line-height: 20px;margin:0;font-weight:normal;overflow:hidden;text-overflow: ellipsis;color:#333;text-align:left;white-space: nowrap;",f.append(h),f.append(g),c.appendChild(d),f.appendTo(c),b.appendChild(c),$(c).hover(function(){self.preventClose=!0},function(){self.preventClose=!1}),gid++}function checkHost(a){var b=document.createElement("a");b.href=a;var c=""+b.hostname;return b=null,location.hostname===c}function showDecodeResult(a){var b=!1;a&&""!=a.trim()&&"error decoding QR Code"!=a||(a='<span style="color: #FF4500">I\'m sorry but i cannot decode this image as a QRCode :(</span>',b=!0),a=a.trim();var c=getContainer(),d=$('<div class="anything-to-qrcode-text-result" style="display:block;padding:30px;width:60%;margin:0 auto;font-size:25px;line-height:1.5;color:#fff;text-align: center;"></div>');d.hover(function(){self.preventClose=!0},function(){self.preventClose=!1}),d.appendTo(c),b||(a+='<input class="a2qtr" value="'+a+'"><br/><button data-clipboard-target=".a2qtr" class="anything-to-qrcode-copy">'+chrome.i18n.getMessage("copy")+'</button><p class="anything-to-qrcode-copy-success">'+chrome.i18n.getMessage("copied")+"</p>"),d.html(a);var e=document.querySelector(".anything-to-qrcode-copy-success");self.clip=new Clipboard(".anything-to-qrcode-copy"),self.clip.on("success",function(a){console.log("copied:",a.text),e.classList.add("show"),setTimeout(function(){e.classList.remove("show")},2500)}),c.style.display="block"}function decodeQr(a){qrcode.callback=function(a){showDecodeResult(a)},qrcode.decode(a)}var self=this,gid=1;chrome.runtime.onMessage.addListener(function(a){a.theTextToQRCode&&""!=a.theTextToQRCode.trim()?createCode(a.theTextToQRCode):a.theImgToDecode?decodeQr(a.theImgToDecode):a.decodeResult&&showDecodeResult(a.decodeResult)}),chrome.runtime.sendMessage("content-script-init",function(){});